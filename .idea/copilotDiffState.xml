<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/data/repository/PerfilRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/data/repository/PerfilRepository.kt" />
              <option name="originalContent" value="package com.example.ecohand.data.repository&#10;&#10;import com.example.ecohand.data.local.dao.EstadisticasUsuarioDao&#10;import com.example.ecohand.data.local.dao.UserDao&#10;import com.example.ecohand.data.local.entity.EstadisticasUsuarioEntity&#10;import com.example.ecohand.data.local.entity.UserEntity&#10;&#10;class PerfilRepository(&#10;    private val userDao: UserDao,&#10;    private val estadisticasUsuarioDao: EstadisticasUsuarioDao&#10;) {&#10;    &#10;    /**&#10;     * Obtiene los datos del usuario por su ID&#10;     */&#10;    suspend fun getUserById(userId: Int): UserEntity? {&#10;        return userDao.getUserById(userId)&#10;    }&#10;    &#10;    /**&#10;     * Obtiene las estadísticas del usuario&#10;     */&#10;    suspend fun getEstadisticasUsuario(userId: Int): EstadisticasUsuarioEntity? {&#10;        return estadisticasUsuarioDao.getEstadisticasByUsuario(userId)&#10;    }&#10;    &#10;    /**&#10;     * Crea estadísticas iniciales para un usuario si no existen&#10;     */&#10;    suspend fun crearEstadisticasIniciales(userId: Int): EstadisticasUsuarioEntity {&#10;        val estadisticas = EstadisticasUsuarioEntity(&#10;            usuarioId = userId,&#10;            puntosTotal = 0,&#10;            rachaActual = 0,&#10;            rachaMayor = 0,&#10;            leccionesCompletadas = 0,&#10;            diasActivos = 0,&#10;            ultimaFechaActiva = null,&#10;            ultimaActualizacion = System.currentTimeMillis()&#10;        )&#10;        estadisticasUsuarioDao.insertEstadisticas(estadisticas)&#10;        return estadisticas&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.ecohand.data.repository&#10;&#10;import com.example.ecohand.data.local.dao.EstadisticasUsuarioDao&#10;import com.example.ecohand.data.local.dao.ProgresoLeccionDao&#10;import com.example.ecohand.data.local.dao.UserDao&#10;import com.example.ecohand.data.local.entity.EstadisticasUsuarioEntity&#10;import com.example.ecohand.data.local.entity.UserEntity&#10;&#10;class PerfilRepository(&#10;    private val userDao: UserDao,&#10;    private val estadisticasUsuarioDao: EstadisticasUsuarioDao,&#10;    private val progresoLeccionDao: ProgresoLeccionDao&#10;) {&#10;    &#10;    /**&#10;     * Obtiene los datos del usuario por su ID&#10;     */&#10;    suspend fun getUserById(userId: Int): UserEntity? {&#10;        return userDao.getUserById(userId)&#10;    }&#10;    &#10;    /**&#10;     * Obtiene las estadísticas del usuario&#10;     */&#10;    suspend fun getEstadisticasUsuario(userId: Int): EstadisticasUsuarioEntity? {&#10;        return estadisticasUsuarioDao.getEstadisticasByUsuario(userId)&#10;    }&#10;    &#10;    /**&#10;     * Obtiene las estadísticas actualizadas del usuario consultando directamente la BD&#10;     */&#10;    suspend fun getEstadisticasActualizadas(userId: Int): EstadisticasUsuarioEntity {&#10;        // Obtener o crear estadísticas&#10;        var estadisticas = estadisticasUsuarioDao.getEstadisticasByUsuario(userId)&#10;        &#10;        if (estadisticas == null) {&#10;            estadisticas = crearEstadisticasIniciales(userId)&#10;        }&#10;        &#10;        // Obtener datos reales de la base de datos&#10;        val leccionesCompletadas = progresoLeccionDao.getLeccionesCompletadasCount(userId)&#10;        val puntosTotales = progresoLeccionDao.getTotalPuntos(userId) ?: 0&#10;        &#10;        // Actualizar si hay diferencias&#10;        if (estadisticas.leccionesCompletadas != leccionesCompletadas || &#10;            estadisticas.puntosTotal != puntosTotales) {&#10;            &#10;            val estadisticasActualizadas = estadisticas.copy(&#10;                leccionesCompletadas = leccionesCompletadas,&#10;                puntosTotal = puntosTotales,&#10;                ultimaActualizacion = System.currentTimeMillis()&#10;            )&#10;            &#10;            estadisticasUsuarioDao.updateEstadisticas(estadisticasActualizadas)&#10;            return estadisticasActualizadas&#10;        }&#10;        &#10;        return estadisticas&#10;    }&#10;    &#10;    /**&#10;     * Crea estadísticas iniciales para un usuario si no existen&#10;     */&#10;    suspend fun crearEstadisticasIniciales(userId: Int): EstadisticasUsuarioEntity {&#10;        val estadisticas = EstadisticasUsuarioEntity(&#10;            usuarioId = userId,&#10;            puntosTotal = 0,&#10;            rachaActual = 0,&#10;            rachaMayor = 0,&#10;            leccionesCompletadas = 0,&#10;            diasActivos = 0,&#10;            ultimaFechaActiva = null,&#10;            ultimaActualizacion = System.currentTimeMillis()&#10;        )&#10;        estadisticasUsuarioDao.insertEstadisticas(estadisticas)&#10;        return estadisticas&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/main/MainScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/main/MainScreen.kt" />
              <option name="originalContent" value="package com.example.ecohand.presentation.main&#10;&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.MaterialTheme&#10;import androidx.compose.material3.NavigationBar&#10;import androidx.compose.material3.NavigationBarItem&#10;import androidx.compose.material3.NavigationBarItemDefaults&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.navigation.NavHostController&#10;import androidx.navigation.NavType&#10;import androidx.navigation.compose.NavHost&#10;import androidx.navigation.compose.composable&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#10;import androidx.navigation.compose.rememberNavController&#10;import androidx.navigation.navArgument&#10;import com.example.ecohand.data.local.database.EcoHandDatabase&#10;import com.example.ecohand.data.repository.DiccionarioRepository&#10;import com.example.ecohand.data.repository.JuegoRepository&#10;import com.example.ecohand.data.repository.PerfilRepository&#10;import com.example.ecohand.data.repository.ProgresoRepository&#10;import com.example.ecohand.data.session.UserSession&#10;import com.example.ecohand.navigation.Screen&#10;import com.example.ecohand.navigation.bottomNavItems&#10;import com.example.ecohand.presentation.diccionario.DiccionarioViewModel&#10;import com.example.ecohand.presentation.home.InicioScreen&#10;import com.example.ecohand.presentation.juegos.JuegosScreen&#10;import com.example.ecohand.presentation.juegos.JuegosViewModel&#10;import com.example.ecohand.presentation.lecciones.LeccionesScreen&#10;import com.example.ecohand.presentation.lecciones.LeccionDetalleScreen&#10;import com.example.ecohand.presentation.lecciones.LeccionPracticaScreen&#10;import com.example.ecohand.presentation.perfil.*&#10;import com.example.ecohand.presentation.progreso.ProgresoScreen&#10;import com.example.ecohand.presentation.progreso.ProgresoViewModel&#10;&#10;@Composable&#10;fun MainScreen() {&#10;    val navController = rememberNavController()&#10;    val context = LocalContext.current&#10;&#10;    // Inicializar base de datos y repositorios&#10;    val database = EcoHandDatabase.getDatabase(context)&#10;    val userSession = UserSession.getInstance(context)&#10;    val usuarioId = userSession.getUserId()&#10;&#10;    // Crear ProgresoRepository&#10;    val progresoRepository = ProgresoRepository(&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao(),&#10;        progresoLeccionDao = database.progresoLeccionDao(),&#10;        actividadDiariaDao = database.actividadDiariaDao(),&#10;        logroDao = database.logroDao(),&#10;        logroUsuarioDao = database.logroUsuarioDao(),&#10;        leccionDao = database.leccionDao()&#10;    )&#10;&#10;    // Crear ProgresoViewModel con remember para evitar recreaciones&#10;    val progresoViewModel = remember(usuarioId) {&#10;        ProgresoViewModel(progresoRepository, usuarioId)&#10;    }&#10;&#10;    // Crear JuegoRepository&#10;    val juegoRepository = JuegoRepository(&#10;        senaDao = database.senaDao(),&#10;        partidaJuegoDao = database.partidaJuegoDao(),&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao()&#10;    )&#10;&#10;    // Crear JuegosViewModel con remember para evitar recreaciones&#10;    val juegosViewModel = remember(usuarioId) {&#10;        JuegosViewModel(juegoRepository, usuarioId)&#10;    }&#10;&#10;    // Crear PerfilRepository&#10;    val perfilRepository = PerfilRepository(&#10;        userDao = database.userDao(),&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao()&#10;    )&#10;&#10;    // Crear PerfilViewModel con remember para evitar recreaciones&#10;    val perfilViewModel = remember(usuarioId) {&#10;        PerfilViewModel(perfilRepository, usuarioId)&#10;    }&#10;&#10;    // Crear DiccionarioRepository&#10;    val diccionarioRepository = DiccionarioRepository(&#10;        senaDao = database.senaDao()&#10;    )&#10;&#10;    // Crear DiccionarioViewModel con remember para evitar recreaciones&#10;    val diccionarioViewModel = remember {&#10;        DiccionarioViewModel(diccionarioRepository)&#10;    }&#10;&#10;    Scaffold(&#10;        bottomBar = { &#10;            val currentRoute = navController.currentBackStackEntryAsState().value?.destination?.route&#10;            // Ocultar bottom bar en pantallas de detalle y práctica&#10;            if (currentRoute != null &amp;&amp; &#10;                !currentRoute.startsWith(&quot;leccion_detalle&quot;) &amp;&amp; &#10;                !currentRoute.startsWith(&quot;leccion_practica&quot;)) {&#10;                BottomNavigationBar(navController = navController)&#10;            }&#10;        }&#10;    ) { innerPadding -&gt;&#10;        MainNavHost(&#10;            navController = navController,&#10;            progresoViewModel = progresoViewModel,&#10;            juegosViewModel = juegosViewModel,&#10;            perfilViewModel = perfilViewModel,&#10;            diccionarioViewModel = diccionarioViewModel,&#10;            modifier = Modifier.padding(innerPadding)&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun BottomNavigationBar(navController: NavHostController) {&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#10;    val currentRoute = navBackStackEntry?.destination?.route&#10;    &#10;    NavigationBar(&#10;        containerColor = MaterialTheme.colorScheme.primary,&#10;        contentColor = MaterialTheme.colorScheme.onPrimary&#10;    ) {&#10;        bottomNavItems.forEach { item -&gt;&#10;            val isSelected = currentRoute == item.route&#10;            NavigationBarItem(&#10;                icon = {&#10;                    Icon(&#10;                        imageVector = if (isSelected) item.selectedIcon else item.icon,&#10;                        contentDescription = item.title&#10;                    )&#10;                },&#10;                label = { Text(text = item.title) },&#10;                selected = isSelected,&#10;                onClick = {&#10;                    navController.navigate(item.route) {&#10;                        navController.graph.startDestinationRoute?.let { route -&gt;&#10;                            popUpTo(route) {&#10;                                saveState = true&#10;                            }&#10;                        }&#10;                        launchSingleTop = true&#10;                        restoreState = true&#10;                    }&#10;                },&#10;                colors = NavigationBarItemDefaults.colors(&#10;                    selectedIconColor = MaterialTheme.colorScheme.onPrimary,&#10;                    selectedTextColor = MaterialTheme.colorScheme.onPrimary,&#10;                    unselectedIconColor = MaterialTheme.colorScheme.onPrimary.copy(alpha = 0.6f),&#10;                    unselectedTextColor = MaterialTheme.colorScheme.onPrimary.copy(alpha = 0.6f),&#10;                    indicatorColor = MaterialTheme.colorScheme.secondary&#10;                )&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun MainNavHost(&#10;    navController: NavHostController,&#10;    progresoViewModel: ProgresoViewModel,&#10;    juegosViewModel: JuegosViewModel,&#10;    perfilViewModel: PerfilViewModel,&#10;    diccionarioViewModel: DiccionarioViewModel,&#10;    modifier: Modifier = Modifier&#10;) {&#10;    NavHost(&#10;        navController = navController,&#10;        startDestination = Screen.Inicio.route,&#10;        modifier = modifier&#10;    ) {&#10;        composable(Screen.Inicio.route) {&#10;            InicioScreen(&#10;                onNavigateToLeccion = { leccionId -&gt;&#10;                    navController.navigate(Screen.LeccionDetalle.createRoute(leccionId))&#10;                }&#10;            )&#10;        }&#10;        composable(Screen.Lecciones.route) {&#10;            LeccionesScreen(&#10;                onNavigateToDetalle = { leccionId -&gt;&#10;                    navController.navigate(Screen.LeccionDetalle.createRoute(leccionId))&#10;                }&#10;            )&#10;        }&#10;        composable(&#10;            route = Screen.LeccionDetalle.route,&#10;            arguments = listOf(navArgument(&quot;leccionId&quot;) { type = NavType.IntType })&#10;        ) { backStackEntry -&gt;&#10;            val leccionId = backStackEntry.arguments?.getInt(&quot;leccionId&quot;) ?: return@composable&#10;            LeccionDetalleScreen(&#10;                leccionId = leccionId,&#10;                onNavigateBack = { navController.popBackStack() },&#10;                onNavigateToPractica = { id -&gt;&#10;                    navController.navigate(Screen.LeccionPractica.createRoute(id))&#10;                }&#10;            )&#10;        }&#10;        composable(&#10;            route = Screen.LeccionPractica.route,&#10;            arguments = listOf(navArgument(&quot;leccionId&quot;) { type = NavType.IntType })&#10;        ) { backStackEntry -&gt;&#10;            val leccionId = backStackEntry.arguments?.getInt(&quot;leccionId&quot;) ?: return@composable&#10;            LeccionPracticaScreen(&#10;                leccionId = leccionId,&#10;                onNavigateBack = { navController.popBackStack() },&#10;                onLeccionCompletada = {&#10;                    // Volver a la lista de lecciones&#10;                    navController.popBackStack(Screen.Lecciones.route, inclusive = false)&#10;                }&#10;            )&#10;        }&#10;        composable(Screen.Progreso.route) {&#10;            ProgresoScreen(viewModel = progresoViewModel)&#10;        }&#10;        composable(Screen.Juegos.route) {&#10;            JuegosScreen(viewModel = juegosViewModel)&#10;        }&#10;        composable(Screen.Perfil.route) {&#10;            PerfilScreen(&#10;                viewModel = perfilViewModel,&#10;                onNavigateToConfiguracion = { &#10;                    navController.navigate(Screen.Configuracion.route)&#10;                },&#10;                onNavigateToMisLogros = { &#10;                    navController.navigate(Screen.MisLogros.route)&#10;                },&#10;                onNavigateToDiccionario = { &#10;                    navController.navigate(Screen.DiccionarioLSP.route)&#10;                },&#10;                onNavigateToCompartir = { &#10;                    navController.navigate(Screen.CompartirApp.route)&#10;                },&#10;                onNavigateToAyuda = { &#10;                    navController.navigate(Screen.AyudaSoporte.route)&#10;                }&#10;            )&#10;        }&#10;        &#10;        // Pantallas de perfil&#10;        composable(Screen.Configuracion.route) {&#10;            ConfiguracionScreen(&#10;                onNavigateBack = { navController.popBackStack() }&#10;            )&#10;        }&#10;        composable(Screen.MisLogros.route) {&#10;            MisLogrosScreen(&#10;                onNavigateBack = { navController.popBackStack() }&#10;            )&#10;        }&#10;        composable(Screen.DiccionarioLSP.route) {&#10;            DiccionarioLSPScreen(&#10;                viewModel = diccionarioViewModel,&#10;                onNavigateBack = { navController.popBackStack() }&#10;            )&#10;        }&#10;        composable(Screen.CompartirApp.route) {&#10;            CompartirAppScreen(&#10;                onNavigateBack = { navController.popBackStack() }&#10;            )&#10;        }&#10;        composable(Screen.AyudaSoporte.route) {&#10;            AyudaSoporteScreen(&#10;                onNavigateBack = { navController.popBackStack() }&#10;            )&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.ecohand.presentation.main&#13;&#10;&#13;&#10;import androidx.compose.foundation.layout.padding&#13;&#10;import androidx.compose.material3.Icon&#13;&#10;import androidx.compose.material3.MaterialTheme&#13;&#10;import androidx.compose.material3.NavigationBar&#13;&#10;import androidx.compose.material3.NavigationBarItem&#13;&#10;import androidx.compose.material3.NavigationBarItemDefaults&#13;&#10;import androidx.compose.material3.Scaffold&#13;&#10;import androidx.compose.material3.Text&#13;&#10;import androidx.compose.runtime.Composable&#13;&#10;import androidx.compose.runtime.getValue&#13;&#10;import androidx.compose.runtime.remember&#13;&#10;import androidx.compose.ui.Modifier&#13;&#10;import androidx.compose.ui.platform.LocalContext&#13;&#10;import androidx.navigation.NavHostController&#13;&#10;import androidx.navigation.NavType&#13;&#10;import androidx.navigation.compose.NavHost&#13;&#10;import androidx.navigation.compose.composable&#13;&#10;import androidx.navigation.compose.currentBackStackEntryAsState&#13;&#10;import androidx.navigation.compose.rememberNavController&#13;&#10;import androidx.navigation.navArgument&#13;&#10;import com.example.ecohand.data.local.database.EcoHandDatabase&#13;&#10;import com.example.ecohand.data.repository.DiccionarioRepository&#13;&#10;import com.example.ecohand.data.repository.JuegoRepository&#13;&#10;import com.example.ecohand.data.repository.PerfilRepository&#13;&#10;import com.example.ecohand.data.repository.ProgresoRepository&#13;&#10;import com.example.ecohand.data.session.UserSession&#13;&#10;import com.example.ecohand.navigation.Screen&#13;&#10;import com.example.ecohand.navigation.bottomNavItems&#13;&#10;import com.example.ecohand.presentation.diccionario.DiccionarioViewModel&#13;&#10;import com.example.ecohand.presentation.home.InicioScreen&#13;&#10;import com.example.ecohand.presentation.juegos.JuegosScreen&#13;&#10;import com.example.ecohand.presentation.juegos.JuegosViewModel&#13;&#10;import com.example.ecohand.presentation.lecciones.LeccionesScreen&#13;&#10;import com.example.ecohand.presentation.lecciones.LeccionDetalleScreen&#13;&#10;import com.example.ecohand.presentation.lecciones.LeccionPracticaScreen&#13;&#10;import com.example.ecohand.presentation.perfil.*&#13;&#10;import com.example.ecohand.presentation.progreso.ProgresoScreen&#13;&#10;import com.example.ecohand.presentation.progreso.ProgresoViewModel&#13;&#10;&#13;&#10;@Composable&#13;&#10;fun MainScreen() {&#13;&#10;    val navController = rememberNavController()&#13;&#10;    val context = LocalContext.current&#13;&#10;&#13;&#10;    // Inicializar base de datos y repositorios&#13;&#10;    val database = EcoHandDatabase.getDatabase(context)&#13;&#10;    val userSession = UserSession.getInstance(context)&#13;&#10;    val usuarioId = userSession.getUserId()&#13;&#10;&#13;&#10;    // Crear ProgresoRepository&#13;&#10;    val progresoRepository = ProgresoRepository(&#13;&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao(),&#13;&#10;        progresoLeccionDao = database.progresoLeccionDao(),&#13;&#10;        actividadDiariaDao = database.actividadDiariaDao(),&#13;&#10;        logroDao = database.logroDao(),&#13;&#10;        logroUsuarioDao = database.logroUsuarioDao(),&#13;&#10;        leccionDao = database.leccionDao()&#13;&#10;    )&#13;&#10;&#13;&#10;    // Crear ProgresoViewModel con remember para evitar recreaciones&#13;&#10;    val progresoViewModel = remember(usuarioId) {&#13;&#10;        ProgresoViewModel(progresoRepository, usuarioId)&#13;&#10;    }&#13;&#10;&#13;&#10;    // Crear JuegoRepository&#13;&#10;    val juegoRepository = JuegoRepository(&#13;&#10;        senaDao = database.senaDao(),&#13;&#10;        partidaJuegoDao = database.partidaJuegoDao(),&#13;&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao()&#13;&#10;    )&#13;&#10;&#13;&#10;    // Crear JuegosViewModel con remember para evitar recreaciones&#13;&#10;    val juegosViewModel = remember(usuarioId) {&#13;&#10;        JuegosViewModel(juegoRepository, usuarioId)&#13;&#10;    }&#13;&#10;&#13;&#10;    // Crear PerfilRepository&#10;    val perfilRepository = PerfilRepository(&#10;        userDao = database.userDao(),&#10;        estadisticasUsuarioDao = database.estadisticasUsuarioDao(),&#10;        progresoLeccionDao = database.progresoLeccionDao()&#10;    )&#13;&#10;&#13;&#10;    // Crear PerfilViewModel con remember para evitar recreaciones&#13;&#10;    val perfilViewModel = remember(usuarioId) {&#13;&#10;        PerfilViewModel(perfilRepository, usuarioId)&#13;&#10;    }&#13;&#10;&#13;&#10;    // Crear DiccionarioRepository&#13;&#10;    val diccionarioRepository = DiccionarioRepository(&#13;&#10;        senaDao = database.senaDao()&#13;&#10;    )&#13;&#10;&#13;&#10;    // Crear DiccionarioViewModel con remember para evitar recreaciones&#13;&#10;    val diccionarioViewModel = remember {&#13;&#10;        DiccionarioViewModel(diccionarioRepository)&#13;&#10;    }&#13;&#10;&#13;&#10;    Scaffold(&#13;&#10;        bottomBar = { &#13;&#10;            val currentRoute = navController.currentBackStackEntryAsState().value?.destination?.route&#13;&#10;            // Ocultar bottom bar en pantallas de detalle y práctica&#13;&#10;            if (currentRoute != null &amp;&amp; &#13;&#10;                !currentRoute.startsWith(&quot;leccion_detalle&quot;) &amp;&amp; &#13;&#10;                !currentRoute.startsWith(&quot;leccion_practica&quot;)) {&#13;&#10;                BottomNavigationBar(navController = navController)&#13;&#10;            }&#13;&#10;        }&#13;&#10;    ) { innerPadding -&gt;&#13;&#10;        MainNavHost(&#13;&#10;            navController = navController,&#13;&#10;            progresoViewModel = progresoViewModel,&#13;&#10;            juegosViewModel = juegosViewModel,&#13;&#10;            perfilViewModel = perfilViewModel,&#13;&#10;            diccionarioViewModel = diccionarioViewModel,&#13;&#10;            modifier = Modifier.padding(innerPadding)&#13;&#10;        )&#13;&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;@Composable&#13;&#10;fun BottomNavigationBar(navController: NavHostController) {&#13;&#10;    val navBackStackEntry by navController.currentBackStackEntryAsState()&#13;&#10;    val currentRoute = navBackStackEntry?.destination?.route&#13;&#10;    &#13;&#10;    NavigationBar(&#13;&#10;        containerColor = MaterialTheme.colorScheme.primary,&#13;&#10;        contentColor = MaterialTheme.colorScheme.onPrimary&#13;&#10;    ) {&#13;&#10;        bottomNavItems.forEach { item -&gt;&#13;&#10;            val isSelected = currentRoute == item.route&#13;&#10;            NavigationBarItem(&#13;&#10;                icon = {&#13;&#10;                    Icon(&#13;&#10;                        imageVector = if (isSelected) item.selectedIcon else item.icon,&#13;&#10;                        contentDescription = item.title&#13;&#10;                    )&#13;&#10;                },&#13;&#10;                label = { Text(text = item.title) },&#13;&#10;                selected = isSelected,&#13;&#10;                onClick = {&#13;&#10;                    navController.navigate(item.route) {&#13;&#10;                        navController.graph.startDestinationRoute?.let { route -&gt;&#13;&#10;                            popUpTo(route) {&#13;&#10;                                saveState = true&#13;&#10;                            }&#13;&#10;                        }&#13;&#10;                        launchSingleTop = true&#13;&#10;                        restoreState = true&#13;&#10;                    }&#13;&#10;                },&#13;&#10;                colors = NavigationBarItemDefaults.colors(&#13;&#10;                    selectedIconColor = MaterialTheme.colorScheme.onPrimary,&#13;&#10;                    selectedTextColor = MaterialTheme.colorScheme.onPrimary,&#13;&#10;                    unselectedIconColor = MaterialTheme.colorScheme.onPrimary.copy(alpha = 0.6f),&#13;&#10;                    unselectedTextColor = MaterialTheme.colorScheme.onPrimary.copy(alpha = 0.6f),&#13;&#10;                    indicatorColor = MaterialTheme.colorScheme.secondary&#13;&#10;                )&#13;&#10;            )&#13;&#10;        }&#13;&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;@Composable&#13;&#10;fun MainNavHost(&#13;&#10;    navController: NavHostController,&#13;&#10;    progresoViewModel: ProgresoViewModel,&#13;&#10;    juegosViewModel: JuegosViewModel,&#13;&#10;    perfilViewModel: PerfilViewModel,&#13;&#10;    diccionarioViewModel: DiccionarioViewModel,&#13;&#10;    modifier: Modifier = Modifier&#13;&#10;) {&#13;&#10;    NavHost(&#13;&#10;        navController = navController,&#13;&#10;        startDestination = Screen.Inicio.route,&#13;&#10;        modifier = modifier&#13;&#10;    ) {&#13;&#10;        composable(Screen.Inicio.route) {&#13;&#10;            InicioScreen(&#13;&#10;                onNavigateToLeccion = { leccionId -&gt;&#13;&#10;                    navController.navigate(Screen.LeccionDetalle.createRoute(leccionId))&#13;&#10;                }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.Lecciones.route) {&#13;&#10;            LeccionesScreen(&#13;&#10;                onNavigateToDetalle = { leccionId -&gt;&#13;&#10;                    navController.navigate(Screen.LeccionDetalle.createRoute(leccionId))&#13;&#10;                }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(&#13;&#10;            route = Screen.LeccionDetalle.route,&#13;&#10;            arguments = listOf(navArgument(&quot;leccionId&quot;) { type = NavType.IntType })&#13;&#10;        ) { backStackEntry -&gt;&#13;&#10;            val leccionId = backStackEntry.arguments?.getInt(&quot;leccionId&quot;) ?: return@composable&#13;&#10;            LeccionDetalleScreen(&#13;&#10;                leccionId = leccionId,&#13;&#10;                onNavigateBack = { navController.popBackStack() },&#13;&#10;                onNavigateToPractica = { id -&gt;&#13;&#10;                    navController.navigate(Screen.LeccionPractica.createRoute(id))&#13;&#10;                }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(&#13;&#10;            route = Screen.LeccionPractica.route,&#13;&#10;            arguments = listOf(navArgument(&quot;leccionId&quot;) { type = NavType.IntType })&#13;&#10;        ) { backStackEntry -&gt;&#13;&#10;            val leccionId = backStackEntry.arguments?.getInt(&quot;leccionId&quot;) ?: return@composable&#13;&#10;            LeccionPracticaScreen(&#13;&#10;                leccionId = leccionId,&#13;&#10;                onNavigateBack = { navController.popBackStack() },&#13;&#10;                onLeccionCompletada = {&#13;&#10;                    // Volver a la lista de lecciones&#13;&#10;                    navController.popBackStack(Screen.Lecciones.route, inclusive = false)&#13;&#10;                }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.Progreso.route) {&#13;&#10;            ProgresoScreen(viewModel = progresoViewModel)&#13;&#10;        }&#13;&#10;        composable(Screen.Juegos.route) {&#13;&#10;            JuegosScreen(viewModel = juegosViewModel)&#13;&#10;        }&#13;&#10;        composable(Screen.Perfil.route) {&#13;&#10;            PerfilScreen(&#13;&#10;                viewModel = perfilViewModel,&#13;&#10;                onNavigateToConfiguracion = { &#13;&#10;                    navController.navigate(Screen.Configuracion.route)&#13;&#10;                },&#13;&#10;                onNavigateToMisLogros = { &#13;&#10;                    navController.navigate(Screen.MisLogros.route)&#13;&#10;                },&#13;&#10;                onNavigateToDiccionario = { &#13;&#10;                    navController.navigate(Screen.DiccionarioLSP.route)&#13;&#10;                },&#13;&#10;                onNavigateToCompartir = { &#13;&#10;                    navController.navigate(Screen.CompartirApp.route)&#13;&#10;                },&#13;&#10;                onNavigateToAyuda = { &#13;&#10;                    navController.navigate(Screen.AyudaSoporte.route)&#13;&#10;                }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        &#13;&#10;        // Pantallas de perfil&#13;&#10;        composable(Screen.Configuracion.route) {&#13;&#10;            ConfiguracionScreen(&#13;&#10;                onNavigateBack = { navController.popBackStack() }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.MisLogros.route) {&#13;&#10;            MisLogrosScreen(&#13;&#10;                onNavigateBack = { navController.popBackStack() }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.DiccionarioLSP.route) {&#13;&#10;            DiccionarioLSPScreen(&#13;&#10;                viewModel = diccionarioViewModel,&#13;&#10;                onNavigateBack = { navController.popBackStack() }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.CompartirApp.route) {&#13;&#10;            CompartirAppScreen(&#13;&#10;                onNavigateBack = { navController.popBackStack() }&#13;&#10;            )&#13;&#10;        }&#13;&#10;        composable(Screen.AyudaSoporte.route) {&#13;&#10;            AyudaSoporteScreen(&#13;&#10;                onNavigateBack = { navController.popBackStack() }&#13;&#10;            )&#13;&#10;        }&#13;&#10;    }&#13;&#10;}&#13;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/perfil/ConfiguracionScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/perfil/ConfiguracionScreen.kt" />
              <option name="originalContent" value="package com.example.ecohand.presentation.perfil&#10;&#10;import android.app.Activity&#10;import android.content.Context&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.ecohand.data.session.UserSession&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ConfiguracionScreen(&#10;    onNavigateBack: () -&gt; Unit&#10;) {&#10;    val context = LocalContext.current&#10;    val userSession = remember { UserSession.getInstance(context) }&#10;&#10;    var notificacionesActivas by remember { mutableStateOf(true) }&#10;    var sonidoActivo by remember { mutableStateOf(true) }&#10;    var vibracionActiva by remember { mutableStateOf(true) }&#10;    var modoOscuro by remember { mutableStateOf(false) }&#10;    var showLogoutDialog by remember { mutableStateOf(false) }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = {&#10;                    Text(&#10;                        text = &quot;Configuración&quot;,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Volver&quot;&#10;                        )&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.primary,&#10;                    titleContentColor = MaterialTheme.colorScheme.onPrimary,&#10;                    navigationIconContentColor = MaterialTheme.colorScheme.onPrimary&#10;                )&#10;            )&#10;        }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;                .background(MaterialTheme.colorScheme.background)&#10;                .padding(16.dp),&#10;            verticalArrangement = Arrangement.spacedBy(12.dp)&#10;        ) {&#10;            // Sección: General&#10;            item {&#10;                Text(&#10;                    text = &quot;General&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(vertical = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.Notifications,&#10;                    titulo = &quot;Notificaciones&quot;,&#10;                    subtitulo = &quot;Recibe recordatorios de práctica&quot;,&#10;                    checked = notificacionesActivas,&#10;                    onCheckedChange = { notificacionesActivas = it }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.AccountCircle,&#10;                    titulo = &quot;Sonido&quot;,&#10;                    subtitulo = &quot;Efectos de sonido en la app&quot;,&#10;                    checked = sonidoActivo,&#10;                    onCheckedChange = { sonidoActivo = it }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.Phone,&#10;                    titulo = &quot;Vibración&quot;,&#10;                    subtitulo = &quot;Vibración al interactuar&quot;,&#10;                    checked = vibracionActiva,&#10;                    onCheckedChange = { vibracionActiva = it }&#10;                )&#10;            }&#10;&#10;            // Sección: Apariencia&#10;            item {&#10;                Text(&#10;                    text = &quot;Apariencia&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.Call,&#10;                    titulo = &quot;Modo Oscuro&quot;,&#10;                    subtitulo = &quot;Activar tema oscuro (Próximamente)&quot;,&#10;                    checked = modoOscuro,&#10;                    onCheckedChange = { modoOscuro = it },&#10;                    enabled = false&#10;                )&#10;            }&#10;&#10;            // Sección: Cuenta&#10;            item {&#10;                Text(&#10;                    text = &quot;Cuenta&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Lock,&#10;                    titulo = &quot;Cambiar Contraseña&quot;,&#10;                    subtitulo = &quot;Actualiza tu contraseña&quot;,&#10;                    onClick = { /* TODO: Implementar cambio de contraseña */ }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Delete,&#10;                    titulo = &quot;Eliminar Cuenta&quot;,&#10;                    subtitulo = &quot;Eliminar permanentemente tu cuenta&quot;,&#10;                    onClick = { /* TODO: Implementar eliminación de cuenta */ },&#10;                    tintColor = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;&#10;            // Sección: Sobre&#10;            item {&#10;                Text(&#10;                    text = &quot;Sobre la App&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Info,&#10;                    titulo = &quot;Versión&quot;,&#10;                    subtitulo = &quot;1.0.0&quot;,&#10;                    onClick = { }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Star,&#10;                    titulo = &quot;Términos y Condiciones&quot;,&#10;                    subtitulo = &quot;Lee nuestros términos de uso&quot;,&#10;                    onClick = { /* TODO: Mostrar términos */ }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Star,&#10;                    titulo = &quot;Política de Privacidad&quot;,&#10;                    subtitulo = &quot;Lee nuestra política de privacidad&quot;,&#10;                    onClick = { /* TODO: Mostrar política */ }&#10;                )&#10;            }&#10;&#10;            // Botón Cerrar Sesión&#10;            item {&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                Button(&#10;                    onClick = { showLogoutDialog = true },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .height(56.dp),&#10;                    colors = ButtonDefaults.buttonColors(&#10;                        containerColor = MaterialTheme.colorScheme.error&#10;                    ),&#10;                    shape = RoundedCornerShape(12.dp)&#10;                ) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.ExitToApp,&#10;                        contentDescription = &quot;Cerrar Sesión&quot;,&#10;                        modifier = Modifier.size(20.dp)&#10;                    )&#10;                    Spacer(modifier = Modifier.width(8.dp))&#10;                    Text(&#10;                        text = &quot;Cerrar Sesión&quot;,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                }&#10;            }&#10;&#10;            item {&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;            }&#10;        }&#10;    }&#10;&#10;    // Dialog de confirmación para cerrar sesión&#10;    if (showLogoutDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showLogoutDialog = false },&#10;            title = {&#10;                Text(&#10;                    text = &quot;Cerrar Sesión&quot;,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            },&#10;            text = {&#10;                Text(&quot;¿Estás seguro que deseas cerrar sesión?&quot;)&#10;            },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        userSession.clearSession()&#10;                        (context as? Activity)?.finishAffinity()&#10;                    }&#10;                ) {&#10;                    Text(&quot;Cerrar Sesión&quot;, color = MaterialTheme.colorScheme.error)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { showLogoutDialog = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ConfiguracionItemSwitch(&#10;    icon: ImageVector,&#10;    titulo: String,&#10;    subtitulo: String,&#10;    checked: Boolean,&#10;    onCheckedChange: (Boolean) -&gt; Unit,&#10;    enabled: Boolean = true&#10;) {&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        shape = RoundedCornerShape(12.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Icon(&#10;                imageVector = icon,&#10;                contentDescription = titulo,&#10;                tint = if (enabled) MaterialTheme.colorScheme.primary else MaterialTheme.colorScheme.onSurfaceVariant,&#10;                modifier = Modifier.size(24.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = titulo,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium,&#10;                    color = if (enabled) MaterialTheme.colorScheme.onSurface else MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;                Text(&#10;                    text = subtitulo,&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;&#10;            Switch(&#10;                checked = checked,&#10;                onCheckedChange = onCheckedChange,&#10;                enabled = enabled&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ConfiguracionItemClick(&#10;    icon: ImageVector,&#10;    titulo: String,&#10;    subtitulo: String,&#10;    onClick: () -&gt; Unit,&#10;    tintColor: androidx.compose.ui.graphics.Color = MaterialTheme.colorScheme.primary&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable(onClick = onClick),&#10;        shape = RoundedCornerShape(12.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Icon(&#10;                imageVector = icon,&#10;                contentDescription = titulo,&#10;                tint = tintColor,&#10;                modifier = Modifier.size(24.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = titulo,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium,&#10;                    color = MaterialTheme.colorScheme.onSurface&#10;                )&#10;                Text(&#10;                    text = subtitulo,&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;&#10;            Icon(&#10;                imageVector = Icons.Default.KeyboardArrowRight,&#10;                contentDescription = &quot;Navegar&quot;,&#10;                tint = MaterialTheme.colorScheme.onSurfaceVariant&#10;            )&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.ecohand.presentation.perfil&#10;&#10;import android.app.Activity&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.text.KeyboardOptions&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.graphics.vector.ImageVector&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.input.KeyboardType&#10;import androidx.compose.ui.text.input.PasswordVisualTransformation&#10;import androidx.compose.ui.text.input.VisualTransformation&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.ecohand.data.local.database.EcoHandDatabase&#10;import com.example.ecohand.data.session.UserSession&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ConfiguracionScreen(&#10;    onNavigateBack: () -&gt; Unit&#10;) {&#10;    val context = LocalContext.current&#10;    val userSession = remember { UserSession.getInstance(context) }&#10;    val database = remember { EcoHandDatabase.getDatabase(context) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    var notificacionesActivas by remember { mutableStateOf(true) }&#10;    var sonidoActivo by remember { mutableStateOf(true) }&#10;    var vibracionActiva by remember { mutableStateOf(true) }&#10;    var showLogoutDialog by remember { mutableStateOf(false) }&#10;    var showVersionDialog by remember { mutableStateOf(false) }&#10;    var showTerminosDialog by remember { mutableStateOf(false) }&#10;    var showPoliticaDialog by remember { mutableStateOf(false) }&#10;    var showCambiarPasswordDialog by remember { mutableStateOf(false) }&#10;&#10;    // Estados para cambiar contraseña&#10;    var passwordActual by remember { mutableStateOf(&quot;&quot;) }&#10;    var passwordNueva by remember { mutableStateOf(&quot;&quot;) }&#10;    var passwordConfirmar by remember { mutableStateOf(&quot;&quot;) }&#10;    var passwordError by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var passwordSuccess by remember { mutableStateOf(false) }&#10;    var isChangingPassword by remember { mutableStateOf(false) }&#10;&#10;    // Para mostrar/ocultar contraseñas&#10;    var showPasswordActual by remember { mutableStateOf(false) }&#10;    var showPasswordNueva by remember { mutableStateOf(false) }&#10;    var showPasswordConfirmar by remember { mutableStateOf(false) }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            TopAppBar(&#10;                title = {&#10;                    Text(&#10;                        text = &quot;Configuración&quot;,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                },&#10;                navigationIcon = {&#10;                    IconButton(onClick = onNavigateBack) {&#10;                        Icon(&#10;                            imageVector = Icons.Default.ArrowBack,&#10;                            contentDescription = &quot;Volver&quot;&#10;                        )&#10;                    }&#10;                },&#10;                colors = TopAppBarDefaults.topAppBarColors(&#10;                    containerColor = MaterialTheme.colorScheme.primary,&#10;                    titleContentColor = MaterialTheme.colorScheme.onPrimary,&#10;                    navigationIconContentColor = MaterialTheme.colorScheme.onPrimary&#10;                )&#10;            )&#10;        }&#10;    ) { paddingValues -&gt;&#10;        LazyColumn(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(paddingValues)&#10;                .background(MaterialTheme.colorScheme.background)&#10;                .padding(16.dp),&#10;            verticalArrangement = Arrangement.spacedBy(12.dp)&#10;        ) {&#10;            // Sección: General&#10;            item {&#10;                Text(&#10;                    text = &quot;General&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(vertical = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.Notifications,&#10;                    titulo = &quot;Notificaciones&quot;,&#10;                    subtitulo = &quot;Recibe recordatorios de práctica&quot;,&#10;                    checked = notificacionesActivas,&#10;                    onCheckedChange = { notificacionesActivas = it }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.AccountCircle,&#10;                    titulo = &quot;Sonido&quot;,&#10;                    subtitulo = &quot;Efectos de sonido en la app&quot;,&#10;                    checked = sonidoActivo,&#10;                    onCheckedChange = { sonidoActivo = it }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemSwitch(&#10;                    icon = Icons.Default.Phone,&#10;                    titulo = &quot;Vibración&quot;,&#10;                    subtitulo = &quot;Vibración al interactuar&quot;,&#10;                    checked = vibracionActiva,&#10;                    onCheckedChange = { vibracionActiva = it }&#10;                )&#10;            }&#10;&#10;&#10;            // Sección: Cuenta&#10;            item {&#10;                Text(&#10;                    text = &quot;Cuenta&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Lock,&#10;                    titulo = &quot;Cambiar Contraseña&quot;,&#10;                    subtitulo = &quot;Actualiza tu contraseña&quot;,&#10;                    onClick = {&#10;                        showCambiarPasswordDialog = true&#10;                        // Resetear campos&#10;                        passwordActual = &quot;&quot;&#10;                        passwordNueva = &quot;&quot;&#10;                        passwordConfirmar = &quot;&quot;&#10;                        passwordError = null&#10;                        passwordSuccess = false&#10;                    }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Delete,&#10;                    titulo = &quot;Eliminar Cuenta&quot;,&#10;                    subtitulo = &quot;Eliminar permanentemente tu cuenta&quot;,&#10;                    onClick = { /* TODO: Implementar eliminación de cuenta */ },&#10;                    tintColor = MaterialTheme.colorScheme.error&#10;                )&#10;            }&#10;&#10;            // Sección: Sobre&#10;            item {&#10;                Text(&#10;                    text = &quot;Sobre la App&quot;,&#10;                    fontSize = 18.sp,&#10;                    fontWeight = FontWeight.Bold,&#10;                    color = MaterialTheme.colorScheme.primary,&#10;                    modifier = Modifier.padding(top = 16.dp, bottom = 8.dp)&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Info,&#10;                    titulo = &quot;Versión&quot;,&#10;                    subtitulo = &quot;1.0.0&quot;,&#10;                    onClick = { showVersionDialog = true }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Star,&#10;                    titulo = &quot;Términos y Condiciones&quot;,&#10;                    subtitulo = &quot;Lee nuestros términos de uso&quot;,&#10;                    onClick = { showTerminosDialog = true }&#10;                )&#10;            }&#10;&#10;            item {&#10;                ConfiguracionItemClick(&#10;                    icon = Icons.Default.Star,&#10;                    titulo = &quot;Política de Privacidad&quot;,&#10;                    subtitulo = &quot;Lee nuestra política de privacidad&quot;,&#10;                    onClick = { showPoliticaDialog = true }&#10;                )&#10;            }&#10;&#10;            // Botón Cerrar Sesión&#10;            item {&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;&#10;                Button(&#10;                    onClick = { showLogoutDialog = true },&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .height(56.dp),&#10;                    colors = ButtonDefaults.buttonColors(&#10;                        containerColor = MaterialTheme.colorScheme.error&#10;                    ),&#10;                    shape = RoundedCornerShape(12.dp)&#10;                ) {&#10;                    Icon(&#10;                        imageVector = Icons.Default.ExitToApp,&#10;                        contentDescription = &quot;Cerrar Sesión&quot;,&#10;                        modifier = Modifier.size(20.dp)&#10;                    )&#10;                    Spacer(modifier = Modifier.width(8.dp))&#10;                    Text(&#10;                        text = &quot;Cerrar Sesión&quot;,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                }&#10;            }&#10;&#10;            item {&#10;                Spacer(modifier = Modifier.height(16.dp))&#10;            }&#10;        }&#10;    }&#10;&#10;    // Dialog de confirmación para cerrar sesión&#10;    if (showLogoutDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showLogoutDialog = false },&#10;            title = {&#10;                Text(&#10;                    text = &quot;Cerrar Sesión&quot;,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            },&#10;            text = {&#10;                Text(&quot;¿Estás seguro que deseas cerrar sesión?&quot;)&#10;            },&#10;            confirmButton = {&#10;                TextButton(&#10;                    onClick = {&#10;                        userSession.clearSession()&#10;                        (context as? Activity)?.finishAffinity()&#10;                    }&#10;                ) {&#10;                    Text(&quot;Cerrar Sesión&quot;, color = MaterialTheme.colorScheme.error)&#10;                }&#10;            },&#10;            dismissButton = {&#10;                TextButton(onClick = { showLogoutDialog = false }) {&#10;                    Text(&quot;Cancelar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;    &#10;    // Dialog de cambiar contraseña&#10;    if (showCambiarPasswordDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { &#10;                if (!isChangingPassword) {&#10;                    showCambiarPasswordDialog = false&#10;                    passwordActual = &quot;&quot;&#10;                    passwordNueva = &quot;&quot;&#10;                    passwordConfirmar = &quot;&quot;&#10;                    passwordError = null&#10;                    passwordSuccess = false&#10;                }&#10;            },&#10;            title = {&#10;                Text(&#10;                    text = &quot;Cambiar Contraseña&quot;,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            },&#10;            text = {&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .heightIn(max = 400.dp),&#10;                    verticalArrangement = Arrangement.spacedBy(12.dp)&#10;                ) {&#10;                    if (passwordSuccess) {&#10;                        // Mensaje de éxito&#10;                        Column(&#10;                            modifier = Modifier.fillMaxWidth(),&#10;                            horizontalAlignment = Alignment.CenterHorizontally&#10;                        ) {&#10;                            Text(&#10;                                text = &quot;✅&quot;,&#10;                                fontSize = 48.sp&#10;                            )&#10;                            Spacer(modifier = Modifier.height(8.dp))&#10;                            Text(&#10;                                text = &quot;Contraseña actualizada exitosamente&quot;,&#10;                                fontSize = 16.sp,&#10;                                fontWeight = FontWeight.Medium,&#10;                                textAlign = androidx.compose.ui.text.style.TextAlign.Center,&#10;                                color = MaterialTheme.colorScheme.primary&#10;                            )&#10;                        }&#10;                    } else {&#10;                        // Campos de contraseña&#10;                        Text(&#10;                            text = &quot;Ingresa tu contraseña actual y la nueva contraseña&quot;,&#10;                            fontSize = 14.sp,&#10;                            color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                        )&#10;                        &#10;                        // Contraseña actual&#10;                        OutlinedTextField(&#10;                            value = passwordActual,&#10;                            onValueChange = { &#10;                                passwordActual = it&#10;                                passwordError = null&#10;                            },&#10;                            label = { Text(&quot;Contraseña Actual&quot;) },&#10;                            placeholder = { Text(&quot;Ingresa tu contraseña actual&quot;) },&#10;                            visualTransformation = if (showPasswordActual) &#10;                                VisualTransformation.None &#10;                            else &#10;                                PasswordVisualTransformation(),&#10;                            keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Password),&#10;                            trailingIcon = {&#10;                                IconButton(onClick = { showPasswordActual = !showPasswordActual }) {&#10;                                    Icon(&#10;                                        imageVector = if (showPasswordActual) &#10;                                            Icons.Default.Person &#10;                                        else &#10;                                            Icons.Default.Lock,&#10;                                        contentDescription = if (showPasswordActual) &#10;                                            &quot;Ocultar contraseña&quot; &#10;                                        else &#10;                                            &quot;Mostrar contraseña&quot;&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth(),&#10;                            enabled = !isChangingPassword,&#10;                            singleLine = true&#10;                        )&#10;                        &#10;                        // Nueva contraseña&#10;                        OutlinedTextField(&#10;                            value = passwordNueva,&#10;                            onValueChange = { &#10;                                passwordNueva = it&#10;                                passwordError = null&#10;                            },&#10;                            label = { Text(&quot;Nueva Contraseña&quot;) },&#10;                            placeholder = { Text(&quot;Ingresa la nueva contraseña&quot;) },&#10;                            visualTransformation = if (showPasswordNueva) &#10;                                VisualTransformation.None &#10;                            else &#10;                                PasswordVisualTransformation(),&#10;                            keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Password),&#10;                            trailingIcon = {&#10;                                IconButton(onClick = { showPasswordNueva = !showPasswordNueva }) {&#10;                                    Icon(&#10;                                        imageVector = if (showPasswordNueva) &#10;                                            Icons.Default.Person &#10;                                        else &#10;                                            Icons.Default.Lock,&#10;                                        contentDescription = if (showPasswordNueva) &#10;                                            &quot;Ocultar contraseña&quot; &#10;                                        else &#10;                                            &quot;Mostrar contraseña&quot;&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth(),&#10;                            enabled = !isChangingPassword,&#10;                            singleLine = true&#10;                        )&#10;                        &#10;                        // Confirmar nueva contraseña&#10;                        OutlinedTextField(&#10;                            value = passwordConfirmar,&#10;                            onValueChange = { &#10;                                passwordConfirmar = it&#10;                                passwordError = null&#10;                            },&#10;                            label = { Text(&quot;Confirmar Nueva Contraseña&quot;) },&#10;                            placeholder = { Text(&quot;Confirma la nueva contraseña&quot;) },&#10;                            visualTransformation = if (showPasswordConfirmar) &#10;                                VisualTransformation.None &#10;                            else &#10;                                PasswordVisualTransformation(),&#10;                            keyboardOptions = KeyboardOptions(keyboardType = KeyboardType.Password),&#10;                            trailingIcon = {&#10;                                IconButton(onClick = { showPasswordConfirmar = !showPasswordConfirmar }) {&#10;                                    Icon(&#10;                                        imageVector = if (showPasswordConfirmar) &#10;                                            Icons.Default.Person &#10;                                        else &#10;                                            Icons.Default.Lock,&#10;                                        contentDescription = if (showPasswordConfirmar) &#10;                                            &quot;Ocultar contraseña&quot; &#10;                                        else &#10;                                            &quot;Mostrar contraseña&quot;&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.fillMaxWidth(),&#10;                            enabled = !isChangingPassword,&#10;                            singleLine = true&#10;                        )&#10;                        &#10;                        // Mensaje de error&#10;                        passwordError?.let { error -&gt;&#10;                            Text(&#10;                                text = error,&#10;                                color = MaterialTheme.colorScheme.error,&#10;                                fontSize = 13.sp,&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                        &#10;                        // Indicador de progreso&#10;                        if (isChangingPassword) {&#10;                            LinearProgressIndicator(&#10;                                modifier = Modifier.fillMaxWidth()&#10;                            )&#10;                        }&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                if (passwordSuccess) {&#10;                    TextButton(&#10;                        onClick = { &#10;                            showCambiarPasswordDialog = false&#10;                            passwordActual = &quot;&quot;&#10;                            passwordNueva = &quot;&quot;&#10;                            passwordConfirmar = &quot;&quot;&#10;                            passwordError = null&#10;                            passwordSuccess = false&#10;                        }&#10;                    ) {&#10;                        Text(&quot;Cerrar&quot;)&#10;                    }&#10;                } else {&#10;                    TextButton(&#10;                        onClick = {&#10;                            // Validaciones&#10;                            when {&#10;                                passwordActual.isEmpty() -&gt; {&#10;                                    passwordError = &quot;Ingresa tu contraseña actual&quot;&#10;                                }&#10;                                passwordNueva.isEmpty() -&gt; {&#10;                                    passwordError = &quot;Ingresa la nueva contraseña&quot;&#10;                                }&#10;                                passwordNueva.length &lt; 6 -&gt; {&#10;                                    passwordError = &quot;La contraseña debe tener al menos 6 caracteres&quot;&#10;                                }&#10;                                passwordConfirmar.isEmpty() -&gt; {&#10;                                    passwordError = &quot;Confirma la nueva contraseña&quot;&#10;                                }&#10;                                passwordNueva != passwordConfirmar -&gt; {&#10;                                    passwordError = &quot;Las contraseñas no coinciden&quot;&#10;                                }&#10;                                passwordActual == passwordNueva -&gt; {&#10;                                    passwordError = &quot;La nueva contraseña debe ser diferente a la actual&quot;&#10;                                }&#10;                                else -&gt; {&#10;                                    // Validar contraseña actual y actualizar&#10;                                    isChangingPassword = true&#10;                                    passwordError = null&#10;                                    &#10;                                    scope.launch(Dispatchers.IO) {&#10;                                        try {&#10;                                            val userId = userSession.getUserId()&#10;                                            val user = database.userDao().getUserById(userId)&#10;                                            &#10;                                            if (user != null) {&#10;                                                // Verificar contraseña actual&#10;                                                if (user.password == passwordActual) {&#10;                                                    // Actualizar contraseña&#10;                                                    val updatedUser = user.copy(password = passwordNueva)&#10;                                                    database.userDao().updateUser(updatedUser)&#10;                                                    &#10;                                                    // Mostrar mensaje de éxito&#10;                                                    launch(Dispatchers.Main) {&#10;                                                        passwordSuccess = true&#10;                                                        isChangingPassword = false&#10;                                                    }&#10;                                                } else {&#10;                                                    // Contraseña actual incorrecta&#10;                                                    launch(Dispatchers.Main) {&#10;                                                        passwordError = &quot;La contraseña actual es incorrecta&quot;&#10;                                                        isChangingPassword = false&#10;                                                    }&#10;                                                }&#10;                                            } else {&#10;                                                launch(Dispatchers.Main) {&#10;                                                    passwordError = &quot;Error: Usuario no encontrado&quot;&#10;                                                    isChangingPassword = false&#10;                                                }&#10;                                            }&#10;                                        } catch (e: Exception) {&#10;                                            launch(Dispatchers.Main) {&#10;                                                passwordError = &quot;Error al cambiar contraseña: ${e.message}&quot;&#10;                                                isChangingPassword = false&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                }&#10;                            }&#10;                        },&#10;                        enabled = !isChangingPassword&#10;                    ) {&#10;                        Text(&quot;Cambiar&quot;)&#10;                    }&#10;                }&#10;            },&#10;            dismissButton = {&#10;                if (!passwordSuccess) {&#10;                    TextButton(&#10;                        onClick = { &#10;                            showCambiarPasswordDialog = false&#10;                            passwordActual = &quot;&quot;&#10;                            passwordNueva = &quot;&quot;&#10;                            passwordConfirmar = &quot;&quot;&#10;                            passwordError = null&#10;                            passwordSuccess = false&#10;                        },&#10;                        enabled = !isChangingPassword&#10;                    ) {&#10;                        Text(&quot;Cancelar&quot;)&#10;                    }&#10;                }&#10;            }&#10;        )&#10;    }&#10;    &#10;    // Dialog de información de versión&#10;    if (showVersionDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showVersionDialog = false },&#10;            title = {&#10;                Column(&#10;                    horizontalAlignment = Alignment.CenterHorizontally,&#10;                    modifier = Modifier.fillMaxWidth()&#10;                ) {&#10;                    Text(&#10;                        text = &quot;&quot;,&#10;                        fontSize = 48.sp&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Text(&#10;                        text = &quot;EcoHand&quot;,&#10;                        fontWeight = FontWeight.Bold,&#10;                        fontSize = 24.sp&#10;                    )&#10;                }&#10;            },&#10;            text = {&#10;                Column {&#10;                    Text(&#10;                        text = &quot;Versión: 1.0.0&quot;,&#10;                        fontSize = 16.sp,&#10;                        fontWeight = FontWeight.Medium,&#10;                        modifier = Modifier.padding(vertical = 4.dp)&#10;                    )&#10;                    Text(&#10;                        text = &quot;Fecha de lanzamiento: Noviembre 2024&quot;,&#10;                        fontSize = 14.sp,&#10;                        color = MaterialTheme.colorScheme.onSurfaceVariant,&#10;                        modifier = Modifier.padding(vertical = 4.dp)&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Text(&#10;                        text = &quot;EcoHand es una aplicación educativa para aprender Lengua de Señas Peruana (LSP) de forma interactiva y divertida.&quot;,&#10;                        fontSize = 14.sp,&#10;                        textAlign = androidx.compose.ui.text.style.TextAlign.Justify&#10;                    )&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;                    Text(&#10;                        text = &quot;© 2024 EcoHand Team&quot;,&#10;                        fontSize = 12.sp,&#10;                        color = MaterialTheme.colorScheme.onSurfaceVariant,&#10;                        fontStyle = androidx.compose.ui.text.font.FontStyle.Italic&#10;                    )&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { showVersionDialog = false }) {&#10;                    Text(&quot;Cerrar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;&#10;    // Dialog de Términos y Condiciones&#10;    if (showTerminosDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showTerminosDialog = false },&#10;            title = {&#10;                Text(&#10;                    text = &quot;Términos y Condiciones&quot;,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            },&#10;            text = {&#10;                LazyColumn(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .heightIn(max = 400.dp)&#10;                ) {&#10;                    item {&#10;                        Text(&#10;                            text = &quot;&quot;&quot;&#10;                                TÉRMINOS Y CONDICIONES DE USO DE ECOHAND&#10;                                &#10;                                Última actualización: Noviembre 2024&#10;                                &#10;                                1. ACEPTACIÓN DE LOS TÉRMINOS&#10;                                Al descargar, instalar o usar la aplicación EcoHand, usted acepta estar sujeto a estos Términos y Condiciones. Si no está de acuerdo con estos términos, por favor no use la aplicación.&#10;                                &#10;                                2. USO DE LA APLICACIÓN&#10;                                EcoHand es una aplicación educativa diseñada para el aprendizaje de la Lengua de Señas Peruana (LSP). El usuario se compromete a:&#10;                                • Usar la aplicación solo con fines educativos&#10;                                • No realizar ingeniería inversa del software&#10;                                • No compartir su cuenta con terceros&#10;                                • Proporcionar información veraz al registrarse&#10;                                &#10;                                3. PROPIEDAD INTELECTUAL&#10;                                Todo el contenido de EcoHand, incluyendo pero no limitado a textos, gráficos, logos, videos, y software, es propiedad de EcoHand Team y está protegido por las leyes de propiedad intelectual.&#10;                                &#10;                                4. PRIVACIDAD&#10;                                EcoHand respeta su privacidad. Los datos recopilados se utilizan únicamente para mejorar la experiencia del usuario y el funcionamiento de la aplicación. No compartimos información personal con terceros.&#10;                                &#10;                                5. MODIFICACIONES&#10;                                Nos reservamos el derecho de modificar estos términos en cualquier momento. Los cambios entrarán en vigor inmediatamente después de su publicación en la aplicación.&#10;                                &#10;                                6. LIMITACIÓN DE RESPONSABILIDAD&#10;                                EcoHand se proporciona &quot;tal cual&quot; sin garantías de ningún tipo. No nos hacemos responsables de daños directos o indirectos derivados del uso de la aplicación.&#10;                                &#10;                                7. CONTACTO&#10;                                Para cualquier pregunta sobre estos términos, contáctenos a través de la sección de Ayuda y Soporte en la aplicación.&#10;                            &quot;&quot;&quot;.trimIndent(),&#10;                            fontSize = 13.sp,&#10;                            textAlign = androidx.compose.ui.text.style.TextAlign.Justify&#10;                        )&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { showTerminosDialog = false }) {&#10;                    Text(&quot;Aceptar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;&#10;    // Dialog de Política de Privacidad&#10;    if (showPoliticaDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showPoliticaDialog = false },&#10;            title = {&#10;                Text(&#10;                    text = &quot;Política de Privacidad&quot;,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;            },&#10;            text = {&#10;                LazyColumn(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .heightIn(max = 400.dp)&#10;                ) {&#10;                    item {&#10;                        Text(&#10;                            text = &quot;&quot;&quot;&#10;                                POLÍTICA DE PRIVACIDAD DE ECOHAND&#10;                                &#10;                                Última actualización: Noviembre 2024&#10;                                &#10;                                1. INFORMACIÓN QUE RECOPILAMOS&#10;                                EcoHand recopila la siguiente información:&#10;                                • Información de cuenta: nombre de usuario, correo electrónico&#10;                                • Datos de progreso: lecciones completadas, puntuaciones, logros&#10;                                • Datos de uso: tiempo de uso, frecuencia de acceso&#10;                                &#10;                                2. CÓMO USAMOS SU INFORMACIÓN&#10;                                Utilizamos la información recopilada para:&#10;                                • Proporcionar y mejorar nuestros servicios&#10;                                • Personalizar su experiencia de aprendizaje&#10;                                • Hacer seguimiento de su progreso&#10;                                • Enviar notificaciones relevantes (si está habilitado)&#10;                                • Analizar el uso de la aplicación para mejoras&#10;                                &#10;                                3. ALMACENAMIENTO DE DATOS&#10;                                Sus datos se almacenan de forma segura en el dispositivo local. La información se mantiene encriptada y protegida mediante las medidas de seguridad estándar de la industria.&#10;                                &#10;                                4. COMPARTIR INFORMACIÓN&#10;                                NO compartimos, vendemos ni alquilamos su información personal a terceros. Sus datos son privados y permanecen en su dispositivo.&#10;                                &#10;                                5. SEGURIDAD&#10;                                Implementamos medidas de seguridad técnicas y organizativas para proteger su información contra acceso no autorizado, alteración, divulgación o destrucción.&#10;                                &#10;                                6. DERECHOS DEL USUARIO&#10;                                Usted tiene derecho a:&#10;                                • Acceder a su información personal&#10;                                • Corregir datos inexactos&#10;                                • Eliminar su cuenta y datos asociados&#10;                                • Exportar sus datos de progreso&#10;                                &#10;                                7. DATOS DE MENORES&#10;                                EcoHand puede ser usado por menores de edad bajo supervisión de un adulto. Los padres o tutores son responsables del uso que los menores hagan de la aplicación.&#10;                                &#10;                                8. CAMBIOS A ESTA POLÍTICA&#10;                                Podemos actualizar esta política periódicamente. Le notificaremos sobre cambios significativos mediante la aplicación.&#10;                                &#10;                                9. COOKIES Y TECNOLOGÍAS SIMILARES&#10;                                EcoHand no utiliza cookies. Toda la información se almacena localmente en su dispositivo.&#10;                                &#10;                                10. CONTACTO&#10;                                Si tiene preguntas sobre esta política de privacidad, puede contactarnos a través de la sección de Ayuda y Soporte.&#10;                                &#10;                                Al usar EcoHand, usted acepta esta Política de Privacidad.&#10;                            &quot;&quot;&quot;.trimIndent(),&#10;                            fontSize = 13.sp,&#10;                            textAlign = androidx.compose.ui.text.style.TextAlign.Justify&#10;                        )&#10;                    }&#10;                }&#10;            },&#10;            confirmButton = {&#10;                TextButton(onClick = { showPoliticaDialog = false }) {&#10;                    Text(&quot;Aceptar&quot;)&#10;                }&#10;            }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ConfiguracionItemSwitch(&#10;    icon: ImageVector,&#10;    titulo: String,&#10;    subtitulo: String,&#10;    checked: Boolean,&#10;    onCheckedChange: (Boolean) -&gt; Unit,&#10;    enabled: Boolean = true&#10;) {&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        shape = RoundedCornerShape(12.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Icon(&#10;                imageVector = icon,&#10;                contentDescription = titulo,&#10;                tint = if (enabled) MaterialTheme.colorScheme.primary else MaterialTheme.colorScheme.onSurfaceVariant,&#10;                modifier = Modifier.size(24.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = titulo,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium,&#10;                    color = if (enabled) MaterialTheme.colorScheme.onSurface else MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;                Text(&#10;                    text = subtitulo,&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;&#10;            Switch(&#10;                checked = checked,&#10;                onCheckedChange = onCheckedChange,&#10;                enabled = enabled&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ConfiguracionItemClick(&#10;    icon: ImageVector,&#10;    titulo: String,&#10;    subtitulo: String,&#10;    onClick: () -&gt; Unit,&#10;    tintColor: androidx.compose.ui.graphics.Color = MaterialTheme.colorScheme.primary&#10;) {&#10;    Card(&#10;        modifier = Modifier&#10;            .fillMaxWidth()&#10;            .clickable(onClick = onClick),&#10;        shape = RoundedCornerShape(12.dp),&#10;        colors = CardDefaults.cardColors(&#10;            containerColor = MaterialTheme.colorScheme.surface&#10;        ),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp)&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp),&#10;            verticalAlignment = Alignment.CenterVertically&#10;        ) {&#10;            Icon(&#10;                imageVector = icon,&#10;                contentDescription = titulo,&#10;                tint = tintColor,&#10;                modifier = Modifier.size(24.dp)&#10;            )&#10;&#10;            Spacer(modifier = Modifier.width(16.dp))&#10;&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = titulo,&#10;                    fontSize = 16.sp,&#10;                    fontWeight = FontWeight.Medium,&#10;                    color = MaterialTheme.colorScheme.onSurface&#10;                )&#10;                Text(&#10;                    text = subtitulo,&#10;                    fontSize = 12.sp,&#10;                    color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                )&#10;            }&#10;&#10;            Icon(&#10;                imageVector = Icons.Default.KeyboardArrowRight,&#10;                contentDescription = &quot;Navegar&quot;,&#10;                tint = MaterialTheme.colorScheme.onSurfaceVariant&#10;            )&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/perfil/PerfilViewModel.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/ecohand/presentation/perfil/PerfilViewModel.kt" />
              <option name="originalContent" value="package com.example.ecohand.presentation.perfil&#10;&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.example.ecohand.data.repository.PerfilRepository&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;&#10;data class PerfilUiState(&#10;    val isLoading: Boolean = true,&#10;    val errorMessage: String? = null,&#10;    &#10;    // Información del usuario&#10;    val username: String = &quot;&quot;,&#10;    val email: String = &quot;&quot;,&#10;    val imagenPerfil: String? = null, // Por ahora null, se usará una default&#10;    &#10;    // Estadísticas&#10;    val puntosTotales: Int = 0,&#10;    val leccionesCompletadas: Int = 0,&#10;    val diasRacha: Int = 0&#10;)&#10;&#10;class PerfilViewModel(&#10;    private val perfilRepository: PerfilRepository,&#10;    private val usuarioId: Int&#10;) : ViewModel() {&#10;    &#10;    private val _uiState = MutableStateFlow(PerfilUiState())&#10;    val uiState: StateFlow&lt;PerfilUiState&gt; = _uiState.asStateFlow()&#10;    &#10;    init {&#10;        cargarPerfilInicial()&#10;    }&#10;&#10;    private fun cargarPerfilInicial() {&#10;        viewModelScope.launch(Dispatchers.IO) {&#10;            cargarPerfil()&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Método público para recargar el perfil&#10;     */&#10;    fun recargarPerfil() {&#10;        viewModelScope.launch(Dispatchers.IO) {&#10;            cargarPerfil()&#10;        }&#10;    }&#10;    &#10;    /**&#10;     * Carga los datos del perfil del usuario&#10;     */&#10;    private suspend fun cargarPerfil() {&#10;        try {&#10;            _uiState.value = _uiState.value.copy(isLoading = true, errorMessage = null)&#10;&#10;            // Obtener datos del usuario&#10;            val usuario = perfilRepository.getUserById(usuarioId)&#10;&#10;            if (usuario == null) {&#10;                _uiState.value = _uiState.value.copy(&#10;                    isLoading = false,&#10;                    errorMessage = &quot;Usuario no encontrado&quot;&#10;                )&#10;                return&#10;            }&#10;&#10;            // Obtener estadísticas del usuario&#10;            var estadisticas = perfilRepository.getEstadisticasUsuario(usuarioId)&#10;&#10;            // Si no existen estadísticas, crear unas iniciales&#10;            if (estadisticas == null) {&#10;                estadisticas = perfilRepository.crearEstadisticasIniciales(usuarioId)&#10;            }&#10;&#10;            // Actualizar UI&#10;            _uiState.value = PerfilUiState(&#10;                isLoading = false,&#10;                username = usuario.username,&#10;                email = usuario.email,&#10;                puntosTotales = estadisticas.puntosTotal,&#10;                leccionesCompletadas = estadisticas.leccionesCompletadas,&#10;                diasRacha = estadisticas.rachaActual&#10;            )&#10;&#10;        } catch (e: Exception) {&#10;            _uiState.value = _uiState.value.copy(&#10;                isLoading = false,&#10;                errorMessage = &quot;Error al cargar el perfil: ${e.message}&quot;&#10;            )&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.ecohand.presentation.perfil&#10;&#10;import androidx.lifecycle.ViewModel&#10;import androidx.lifecycle.viewModelScope&#10;import com.example.ecohand.data.repository.PerfilRepository&#10;import kotlinx.coroutines.Dispatchers&#10;import kotlinx.coroutines.flow.MutableStateFlow&#10;import kotlinx.coroutines.flow.StateFlow&#10;import kotlinx.coroutines.flow.asStateFlow&#10;import kotlinx.coroutines.launch&#10;&#10;data class PerfilUiState(&#10;    val isLoading: Boolean = true,&#10;    val errorMessage: String? = null,&#10;    &#10;    // Información del usuario&#10;    val username: String = &quot;&quot;,&#10;    val email: String = &quot;&quot;,&#10;    val imagenPerfil: String? = null, // Por ahora null, se usará una default&#10;    &#10;    // Estadísticas&#10;    val puntosTotales: Int = 0,&#10;    val leccionesCompletadas: Int = 0,&#10;    val diasRacha: Int = 0&#10;)&#10;&#10;class PerfilViewModel(&#10;    private val perfilRepository: PerfilRepository,&#10;    private val usuarioId: Int&#10;) : ViewModel() {&#10;    &#10;    private val _uiState = MutableStateFlow(PerfilUiState())&#10;    val uiState: StateFlow&lt;PerfilUiState&gt; = _uiState.asStateFlow()&#10;    &#10;    init {&#10;        cargarPerfilInicial()&#10;    }&#10;&#10;    private fun cargarPerfilInicial() {&#10;        viewModelScope.launch(Dispatchers.IO) {&#10;            cargarPerfil()&#10;        }&#10;    }&#10;&#10;    /**&#10;     * Método público para recargar el perfil&#10;     */&#10;    fun recargarPerfil() {&#10;        viewModelScope.launch(Dispatchers.IO) {&#10;            cargarPerfil()&#10;        }&#10;    }&#10;    &#10;    /**&#10;     * Carga los datos del perfil del usuario&#10;     */&#10;    private suspend fun cargarPerfil() {&#10;        try {&#10;            _uiState.value = _uiState.value.copy(isLoading = true, errorMessage = null)&#10;            &#10;            // Obtener datos del usuario&#10;            val usuario = perfilRepository.getUserById(usuarioId)&#10;            &#10;            if (usuario == null) {&#10;                _uiState.value = _uiState.value.copy(&#10;                    isLoading = false,&#10;                    errorMessage = &quot;Usuario no encontrado&quot;&#10;                )&#10;                return&#10;            }&#10;            &#10;            // Obtener estadísticas actualizadas directamente de la BD&#10;            val estadisticas = perfilRepository.getEstadisticasActualizadas(usuarioId)&#10;            &#10;            // Actualizar UI&#10;            _uiState.value = PerfilUiState(&#10;                isLoading = false,&#10;                username = usuario.username,&#10;                email = usuario.email,&#10;                puntosTotales = estadisticas.puntosTotal,&#10;                leccionesCompletadas = estadisticas.leccionesCompletadas,&#10;                diasRacha = estadisticas.rachaActual&#10;            )&#10;            &#10;        } catch (e: Exception) {&#10;            _uiState.value = _uiState.value.copy(&#10;                isLoading = false,&#10;                errorMessage = &quot;Error al cargar el perfil: ${e.message}&quot;&#10;            )&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>